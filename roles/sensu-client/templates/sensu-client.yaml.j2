apiVersion: v1
kind: Pod
metadata:
  name: sensu-client
  namespace: kube-system
spec:
  containers:
  - name: sensu-client
    image: oslobod/sensu
    imagePullPolicy: Always
    args:
    - "client"
    resources:
      limits:
        cpu: 100m
    env:
    - name: RABBITMQ_HOST
      value: "rabbitmq-master"
    - name: RABBITMQ_PORT
      value: "5672"
    - name: CLIENT_ADDRESS
      value: "{{ ansible_hostname }}"
    - name: CLIENT_NAME
      value: "{{ ansible_hostname }}"
    - name: CLIENT_SUBSCRIPTIONS
      value: "all,default,metrics"
    - name: HOST_DEV_DIR
      value: "/host_dev"
    - name: HOST_PROC_DIR
      value: "/host_proc"
    - name: HOST_SYS_DIR
      value: "/host_sys"
    volumeMounts:
    - name: host-dev
      mountPath: /host_dev
      readOnly: true
    - name: host-proc
      mountPath: /host_proc
      readOnly: true
    - name: host-sys
      mountPath: /host_sys
      readOnly: true
  volumes:
  - name: host-dev
    hostPath:
      path: /dev
  - name: host-proc
    hostPath:
      path: /proc
  - name: host-sys
    hostPath:
      path: /sys
