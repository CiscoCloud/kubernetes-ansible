---
- name: Install kubernetes node
  sudo: yes
  yum:
    pkg=kubernetes-node
    state=latest
    enablerepo=virt7-docker-common-candidate
  notify:
    - restart daemons
  tags:
    - minion

- name: write the config files for kubelet
  sudo: yes
  template:
    src: kubelet.j2
    dest: /etc/kubernetes/kubelet
  notify:
    - restart kubelet
  tags:
    - minion

- name: write the config files for proxy
  sudo: yes
  template:
    src: proxy.j2
    dest: /etc/kubernetes/proxy
  notify:
    - restart proxy
  tags:
    - minion

- name: Enable kubelet
  sudo: yes
  service:
    name: kubelet
    enabled: yes
    state: started
  tags:
    - minion

- name: Enable proxy
  sudo: yes
  service:
    name: kube-proxy
    enabled: yes
    state: started
  tags:
    - minion
